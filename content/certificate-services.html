<article>
  <h1>ğŸ” Active Directory Certificate Services (AD CS) â€“ Lab Implementatie</h1>

  <section>
    <h2>ğŸ¯ Doelstelling</h2>
    <p>
      In dit lab leer je hoe je <strong>Active Directory Certificate Services (AD CS)</strong> installeert en configureert
      voor gebruik binnen een Windows Server-domeinomgeving. AD CS biedt een interne <strong>Public Key Infrastructure (PKI)</strong>
      waarmee je beveiligingscertificaten kunt uitgeven, beheren en intrekken voor computers, gebruikers en servers.
    </p>
  </section>

  <section class="infra-flex">
    <h3>ğŸ§° Voorwaarden</h3>

    <div class="infra-flex-row header">
      <div>Voorwaarde</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Voorwaarde">Windows Server lid van domein</div>
      <div data-label="Beschrijving">Bijvoorbeeld <code>lab.local</code></div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Voorwaarde">Administratorrechten</div>
      <div data-label="Beschrijving">Voor installatie en configuratie van AD CS</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Voorwaarde">Statische IP & DNS</div>
      <div data-label="Beschrijving">Zorg voor correcte netwerkconfiguratie</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Voorwaarde">Servernaam</div>
      <div data-label="Beschrijving">Mag niet wijzigen na installatie</div>
    </div>
  </section>

  <section>
    <h2>âš™ï¸ Installatie AD CS</h2>
    <ol>
      <li>Open <strong>Server Manager â†’ Add Roles and Features</strong>.</li>
      <li>Kies <strong>Role-based or feature-based installation</strong> en selecteer de gewenste server.</li>
      <li>Vink <strong>Active Directory Certificate Services</strong> aan.</li>
      <li>Bij rolservices selecteer:
        <ul>
          <li>Certification Authority (CA)</li>
          <li>Certification Authority Web Enrollment (optioneel)</li>
          <li>Online Responder (optioneel)</li>
        </ul>
      </li>
      <li>Klik <strong>Next â†’ Install</strong>.</li>
    </ol>

    <pre><code class="language-powershell">
Install-WindowsFeature AD-Certificate -IncludeManagementTools
    </code></pre>
  </section>

  <section>
    <h2>ğŸ—ï¸ Configuratie van de Certification Authority</h2>
    <ol>
      <li>Klik in Server Manager op <strong>Configure Active Directory Certificate Services</strong>.</li>
      <li>Kies serviceaccount: <strong>Built-in Administrator</strong> of domeinaccount met CA-rechten.</li>
      <li>Selecteer <strong>Certification Authority</strong>.</li>
      <li>Kies CA-type:
        <ul>
          <li>Enterprise CA (aanbevolen voor automatische registratie)</li>
          <li>Standalone CA (handmatige goedkeuring)</li>
        </ul>
      </li>
      <li>Kies <strong>Root CA</strong> en <strong>Create a new private key</strong>:
        <ul>
          <li>Key length: 2048 of 4096 bits</li>
          <li>Hashing: SHA256</li>
        </ul>
      </li>
      <li>Voer CA Common Name in (bijv. <code>LAB-CA</code>) en laat database op standaardlocatie (<code>C:\Windows\System32\CertLog</code>).</li>
      <li>Voltooi de wizard.</li>
    </ol>
  </section>

  <section class="infra-flex">
    <h3>ğŸ“œ Certificaatuitgifte testen</h3>

    <div class="infra-flex-row header">
      <div>Taak</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Open CA-console</div>
      <div data-label="Beschrijving">certsrv.msc â†’ Issued Certificates bekijken</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Handmatig certificaat aanvragen</div>
      <div data-label="Beschrijving">
        MMC â†’ Certificates â†’ Computer Account â†’ Personal â†’ Request New Certificate â†’ Kies template â†’ Enroll
      </div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">PowerShell alternatief</div>
      <div data-label="Beschrijving">
        <pre><code class="language-powershell">
certreq -new request.inf request.req
certreq -submit request.req request.cer
certreq -accept request.cer
        </code></pre>
      </div>
    </div>
  </section>

  <section class="infra-flex">
    <h3>ğŸ”§ Certificatensjablonen (Templates)</h3>

    <div class="infra-flex-row header">
      <div>Taak</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Open Templates</div>
      <div data-label="Beschrijving">CA-console â†’ Certificate Templates â†’ Rechtsklik â†’ Manage</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Kopieer template</div>
      <div data-label="Beschrijving">Bijv. Web Server â†’ geef nieuwe naam â†’ pas Security-tab en Subject Name aan</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Publiceer template</div>
      <div data-label="Beschrijving">
        <pre><code class="language-powershell">
certutil -setcatemplates +IIS_SSL_Template
        </code></pre>
      </div>
    </div>
  </section>

  <section>
    <h2>âš™ï¸ Autoenrollment</h2>
    <ol>
      <li>Open GPMC â†’ Default Domain Policy (of nieuwe GPO).</li>
      <li>Navigeer naar: <code>Computer Configuration â†’ Policies â†’ Windows Settings â†’ Security Settings â†’ Public Key Policies â†’ Certificate Services Client â€“ Auto-Enrollment</code></li>
      <li>Stel in op:
        <ul>
          <li>Configuration Mode: Enabled</li>
          <li>Renew expired certificates, update pending certificates</li>
          <li>Update certificates that use certificate templates</li>
        </ul>
      </li>
      <li>Voer <code>gpupdate /force</code> uit op clients.</li>
      <li>Controleer certificaten in MMC â†’ Personal â†’ Certificates.</li>
    </ol>
  </section>

  <section class="infra-flex">
    <h3>ğŸ§© Certificate Revocation List (CRL)</h3>

    <div class="infra-flex-row header">
      <div>Taak</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Controleer CRL-publicatie</div>
      <div data-label="Beschrijving">certutil -crl â†’ zorg dat CDP toegankelijk is voor domeinleden</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Taak">Verify certificaat</div>
      <div data-label="Beschrijving">certutil -urlfetch -verify certificate.cer</div>
    </div>
  </section>

  <section class="infra-flex">
    <h3>ğŸ§  Best practices</h3>

    <div class="infra-flex-row header">
      <div>Actie</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Actie">Enterprise Root CA</div>
      <div data-label="Beschrijving">Gebruik enkel voor lab; productie: hiÃ«rarchie Root + Issuing CA</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Actie">Private Key</div>
      <div data-label="Beschrijving">Bewaar offline of beveilig met HSM</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Actie">Certificaatduur</div>
      <div data-label="Beschrijving">1 jaar voor servers, 2 jaar voor clients</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Actie">Web Enrollment</div>
      <div data-label="Beschrijving">Gebruik aparte server voor externe aanvragen</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Actie">CRL-publicatie</div>
      <div data-label="Beschrijving">Controleer regelmatig publicatie en expiratie</div>
    </div>
  </section>

  <section>
    <h2>ğŸ§¾ Conclusie</h2>
    <p>
      AD CS biedt een krachtige, geÃ¯ntegreerde oplossing voor het beheren van certificaten binnen het domein.
      Door correcte configuratie van templates, auto-enrollment en CRL-publicatie kun je SSL, authenticatie en encryptie
      centraal beheren in je infrastructuur.
    </p>
  </section>

  <footer></footer>
</article>
