<section>
  <h1>âš–ï¸ Network Load Balancing (NLB) â€“ Hoge beschikbaarheid voor netwerkservices</h1>

  <section>
    <h2>ğŸ¯ Doelstelling</h2>
    <p>
      Configureer <strong>NLB</strong> in Windows Server om inkomend verkeer over meerdere servers te verdelen voor hogere betrouwbaarheid, prestaties en beschikbaarheid.
    </p>
  </section>

  <section class="infra-flex">
    <h2>ğŸ§° Installatie NLB-functie</h2>
    <div class="infra-flex-row header">
      <div>Stap</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">1</div>
      <div data-label="Beschrijving">Server Manager â†’ Add Roles and Features â†’ Features â†’ Network Load Balancing â†’ Install.</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">2</div>
      <div data-label="Beschrijving">PowerShell alternatief:
        <pre><code class="language-powershell">
Install-WindowsFeature NLB -IncludeManagementTools
        </code></pre>
      </div>
    </div>
  </section>

  <section class="infra-flex">
    <h2>ğŸ—ï¸ NLB Cluster aanmaken</h2>
    <div class="infra-flex-row header">
      <div>Stap</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">1</div>
      <div data-label="Beschrijving">Open NLB Manager â†’ Cluster â†’ New â†’ voeg eerste host toe â†’ selecteer NIC â†’ Next.</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">2</div>
      <div data-label="Beschrijving">Cluster IP-adres toevoegen â†’ virtueel IP invullen (bijv. 192.168.10.100) â†’ FQDN optioneel â†’ Next.</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">3</div>
      <div data-label="Beschrijving">Cluster Parameters: kies operation mode (Unicast/Multicast) â†’ Next. Multicast aanbevolen voor virtuele labs.</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">4</div>
      <div data-label="Beschrijving">Port Rules configureren: standaard TCP/UDP 0-65535 of beperkt tot TCP 80/443 â†’ Load Weight instellen â†’ Finish.</div>
    </div>
  </section>

  <section class="infra-flex">
    <h2>ğŸ” Extra nodes toevoegen</h2>
    <div class="infra-flex-row header">
      <div>Stap</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">1</div>
      <div data-label="Beschrijving">Cluster â†’ rechtsklik â†’ Add Host To Cluster â†’ tweede server toevoegen â†’ NIC selecteren â†’ Next â†’ Finish â†’ converged status controleren.</div>
    </div>
  </section>

  <section class="infra-flex">
    <h2>ğŸŒ DNS & Clienttoegang</h2>
    <div class="infra-flex-row header">
      <div>Stap</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">1</div>
      <div data-label="Beschrijving">Maak een DNS A-record voor cluster-IP (bijv. nlb-web.contoso.com â†’ 192.168.10.100).</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">2</div>
      <div data-label="Beschrijving">Clients verbinden via DNS-naam; NLB verdeelt verkeer automatisch.</div>
    </div>
  </section>

  <section class="infra-flex">
    <h2>ğŸ§  Test & validatie</h2>
    <div class="infra-flex-row header">
      <div>Stap</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">1</div>
      <div data-label="Beschrijving">Open browser client â†’ http://nlb-web.contoso.com, refresh pagina of:
        <pre><code class="language-powershell">
Test-NetConnection nlb-web.contoso.com -Port 80
        </code></pre>
      </div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">2</div>
      <div data-label="Beschrijving">Controleer IIS logs op beide nodes voor load balancing.</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">3</div>
      <div data-label="Beschrijving">Stop tijdelijk IIS op Ã©Ã©n node:
        <pre><code class="language-powershell">
Stop-Service W3SVC
        </code></pre>
        Verkeer moet automatisch door andere node worden afgehandeld.
      </div>
    </div>
  </section>

  <section class="infra-flex">
    <h2>ğŸ“Š Monitoring & beheer</h2>
    <div class="infra-flex-row header">
      <div>Stap</div>
      <div>Beschrijving</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">1</div>
      <div data-label="Beschrijving">NLB Manager gebruiken om status nodes te controleren.</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">2</div>
      <div data-label="Beschrijving">PowerShell: Get-NlbCluster / Get-NlbClusterNode / Get-NlbClusterPortRule</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">3</div>
      <div data-label="Beschrijving">Event Viewer: Applications and Services Logs â†’ Microsoft â†’ Windows â†’ NLB</div>
    </div>

    <div class="infra-flex-row">
      <div data-label="Stap">4</div>
      <div data-label="Beschrijving">Performance Monitor gebruiken voor CPU/geheugen per node.</div>
    </div>
  </section>

  <section>
    <h2>ğŸ”’ Best Practices</h2>
    <ul>
      <li>Dedicated NICâ€™s voor NLB en managementverkeer.</li>
      <li>Multicast modus bij virtuele omgevingen.</li>
      <li>Router/switch correct configureren voor multicast (IGMP-snooping).</li>
      <li>HTTPS met geldig certificaat voor webapplicaties.</li>
      <li>Regelmatig clusterconvergentie controleren.</li>
      <li>Statistische load weights instellen bij ongelijke servercapaciteiten.</li>
    </ul>
  </section>

  <section>
    <h2>âš ï¸ Veelvoorkomende problemen</h2>
    <ul>
      <li>Cluster blijft converging: controleer UDP 2504 en NIC-bindingen.</li>
      <li>Clients bereiken cluster niet: firewall en ARP-caching controleren.</li>
      <li>Onregelmatige verdeling: herzie port rules of gebruik Single Affinity.</li>
      <li>Virtuele omgeving: MAC Address Spoofing aanzetten voor NLB NICâ€™s.</li>
    </ul>
  </section>

  <section>
    <h2>ğŸ§¾ Conclusie</h2>
    <p>
      NLB verhoogt betrouwbaarheid, prestaties en schaalbaarheid van netwerkservices. Het integreert naadloos met IIS en RDS en vormt een cruciaal onderdeel van een robuuste infrastructuur.
    </p>
  </section>
</section>
